(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{35:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),o=e(20),i=e.n(o),a=e(6),u=e(3),s=e(2),j="token",b=function(n){localStorage.setItem(j,n)},f=function(){return localStorage.getItem(j)},d="https://student-json-api.lidemy.me",l=function(){var n=f();return fetch("".concat(d,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))},h=Object(c.createContext)(null),O=e(4);function p(){var n=Object(u.a)(["\n  color: red;\n"]);return p=function(){return n},n}var x=s.b.div(p());function v(){var n=Object(c.useContext)(h).setUser,t=Object(c.useState)(""),e=Object(a.a)(t,2),o=e[0],i=e[1],u=Object(c.useState)(""),s=Object(a.a)(u,2),j=s[0],f=s[1],p=Object(c.useState)(),v=Object(a.a)(p,2),g=v[0],m=v[1],y=Object(O.f)();return Object(r.jsxs)("form",{onSubmit:function(t){m(null),function(n,t){return fetch("".concat(d,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(o,j).then((function(t){if(0===t.ok)return m(t.message);b(t.token),l().then((function(t){if(1!==t.ok)return b(null),m(t.toString());n(t.data),y.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:o,onChange:function(n){return i(n.target.value)}})]}),Object(r.jsxs)("div",{children:["password"," ",Object(r.jsx)("input",{type:"password",value:j,onChange:function(n){return f(n.target.value)}})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),g&&Object(r.jsx)(x,{children:g})]})}var g=e(10);function m(){var n=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return m=function(){return n},n}function y(){var n=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return y=function(){return n},n}function w(){var n=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return w=function(){return n},n}function S(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return S=function(){return n},n}var k=s.b.div(S()),C=s.b.div(w()),z=Object(s.b)(g.b)(y()),E=s.b.div(m());function _(n){var t=n.post;return Object(r.jsxs)(C,{children:[Object(r.jsx)(z,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(E,{children:new Date(t.createdAt).toLocaleString()})]})}function D(){var n=Object(c.useState)([]),t=Object(a.a)(n,2),e=t[0],o=t[1];return Object(c.useEffect)((function(){fetch("".concat(d,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()})).then((function(n){return o(n)}))}),[]),Object(r.jsx)(k,{children:e.map((function(n){return Object(r.jsx)(_,{post:n},n.id)}))})}function B(){var n=Object(u.a)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: black;\n  font-size: 24px;\n  background: rgba(0, 0, 0, 0.3);\n"]);return B=function(){return n},n}function J(){var n=Object(u.a)(["\n  white-space: pre-wrap;\n"]);return J=function(){return n},n}function $(){var n=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return $=function(){return n},n}function A(){var n=Object(u.a)([""]);return A=function(){return n},n}function I(){var n=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n"]);return I=function(){return n},n}function L(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return L=function(){return n},n}var P=s.b.div(L()),T=s.b.div(I()),U=s.b.h1(A()),N=s.b.div($()),q=s.b.p(J()),F=s.b.div(B());function G(n){var t=n.post,e=n.onDelete;return t?Object(r.jsxs)(T,{children:[Object(r.jsx)("button",{onClick:e,children:"\u522a\u9664"}),Object(r.jsx)(U,{children:t.title}),Object(r.jsx)(N,{children:new Date(t.createdAt).toLocaleString()}),Object(r.jsx)(q,{children:t.body})]}):null}function H(){var n=Object(c.useState)(),t=Object(a.a)(n,2),e=t[0],o=t[1],i=Object(c.useState)(!1),u=Object(a.a)(i,2),s=u[0],j=u[1],b=Object(O.f)(),l=Object(O.h)().id;return Object(c.useEffect)((function(){j(!0),function(n){return fetch("".concat(d,"/posts/").concat(n,"?_expand=user")).then((function(n){return n.json()}))}(l).then((function(n){j(!1),o(n)})).catch((function(n){j(!1)}))}),[l]),Object(r.jsxs)(P,{children:[Object(r.jsx)(G,{post:e,onDelete:function(){(function(n){var t=f();return fetch("".concat(d,"/posts/").concat(n),{method:"DELETE",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"}}).then((function(n){return n.json()}))})(l).then((function(){b.push("/")}))}}),s&&Object(r.jsx)(F,{children:"\u8f09\u5165\u4e2d"})]})}function K(){var n=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return K=function(){return n},n}function M(){var n=Object(u.a)([""]);return M=function(){return n},n}function Q(){var n=Object(u.a)(["\n  width: 100%;\n  height: 500px;\n  margin-top: 16px;\n"]);return Q=function(){return n},n}function R(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return R=function(){return n},n}var V=s.b.div(R()),W=s.b.textarea(Q()),X=s.b.input(M()),Y=s.b.button(K());function Z(){var n=Object(c.useState)(""),t=Object(a.a)(n,2),e=t[0],o=t[1],i=Object(c.useState)(""),u=Object(a.a)(i,2),s=u[0],j=u[1],b=Object(O.f)();return Object(r.jsxs)(V,{children:[Object(r.jsx)(X,{value:e,onChange:function(n){return o(n.target.value)}}),Object(r.jsx)(W,{onChange:function(n){return j(n.target.value)},children:s}),Object(r.jsx)(Y,{onClick:function(){(function(n){var t=f();return fetch("".concat(d,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"},body:JSON.stringify(n)}).then((function(n){return n.json()}))})({title:e,body:s}).then((function(n){console.log(n),n.id&&b.push("/posts/"+n.id)}))},children:"\u65b0\u589e\u6587\u7ae0"})]})}function nn(){var n=Object(u.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"]);return nn=function(){return n},n}function tn(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"]);return tn=function(){return n},n}function en(){var n=Object(u.a)(["\n  display: flex;\n  align-items: cneter;\n  height: 64px;\n"]);return en=function(){return n},n}function rn(){var n=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]);return rn=function(){return n},n}function cn(){var n=Object(u.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n  box-sizing: border-box;\n"]);return cn=function(){return n},n}var on=s.b.div(cn()),an=s.b.div(rn()),un=s.b.div(en()),sn=Object(s.b)(g.b)(tn(),(function(n){return n.$active&&"\n    background: rgba(0, 0, 0, 0.1);\n  "})),jn=s.b.div(nn(),un);function bn(){var n=Object(O.g)(),t=Object(O.f)(),e=Object(c.useContext)(h),o=e.user,i=e.setUser;return Object(r.jsxs)(on,{children:[Object(r.jsxs)(jn,{children:[Object(r.jsx)(an,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(r.jsxs)(un,{children:[Object(r.jsx)(sn,{to:"/",$active:"/"===n.pathname,children:"\u9996\u9801"}),o&&Object(r.jsx)(sn,{to:"/new-post",$active:"/new-post"===n.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(un,{children:[!o&&Object(r.jsx)(sn,{to:"/login",$active:"/login"===n.pathname,children:"\u767b\u5165"}),o&&Object(r.jsx)(sn,{onClick:function(){b(""),i(null),"/"!==n.pathname&&t.push("/")},children:"\u767b\u51fa"})]})]})}function fn(){var n=Object(u.a)(["\n  padding-top: 64px;\n"]);return fn=function(){return n},n}var dn=s.b.div(fn());var ln=function(){var n=Object(c.useState)(null),t=Object(a.a)(n,2),e=t[0],o=t[1];return Object(c.useEffect)((function(){l().then((function(n){n.ok&&o(n.data)}))}),[]),Object(r.jsx)(h.Provider,{value:{user:e,setUser:o},children:Object(r.jsx)(dn,{children:Object(r.jsxs)(g.a,{children:[Object(r.jsx)(bn,{}),Object(r.jsxs)(O.c,{children:[Object(r.jsx)(O.a,{exact:!0,path:"/",children:Object(r.jsx)(D,{})}),Object(r.jsx)(O.a,{exact:!0,path:"/posts/:id",children:Object(r.jsx)(H,{})}),Object(r.jsx)(O.a,{path:"/new-post",children:Object(r.jsx)(Z,{})}),Object(r.jsx)(O.a,{path:"/login",children:Object(r.jsx)(v,{})})]})]})})})};i.a.render(Object(r.jsx)(s.a,{theme:{colors:{primary_300:"#3333dd",primary_400:"#e33e3e",primary_500:"#af0505"}},children:Object(r.jsx)(ln,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.4e179fba.chunk.js.map